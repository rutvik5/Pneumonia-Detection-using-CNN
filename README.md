# Pneumonia Detection using CNN

Pneumonia is a form of an acute respiratory infection that affects the lungs. The risk of pneumonia is enormous for many, especially for children. According to the World Health Organisation, Pneumonia accounts for 15 percent of all deaths of children under five years old, killing 808,694 children in 2017. The problem is even worse for developing and under-developed countries. The proposed method would help in the early detection of the disease, and consequently, it may benefit many.

Convolutional Neural Network(CNN) is used in multiple computer vision tasks, such as image classification, object detection, etc. While many efforts have been given to general tasks, now the focus has started shifted to medical images. Further, with significant data growth in healthcare communities, medical data could be analysed for early disease detection. 

The project includes a Convolutional Neural Network to detect pneumonia (bacterial or viral) using chest X-ray images database.

## Data Preprocessing
Before feeding the data to our CNN we need to resize images to reduce our training time. As we know that images are stored in the form of pixel in matrices, hence big image sizes means large  matrix multiplications. Thus more computational power and training time would be required when  e feed these images to CNN. Therefore, we have reduced the size of the image to 200*200 pixels. Since, we are dealing with X-rays, we have processed the images in grayscale. We labeled the each image into three categories- Normal, Bacteria-Pneumonia and Virus-Pneumonia. We then, split the data into training and testing data arrays which were later converted to numpy arrays. These numpy arrays were then fed into the neural network. While training the model, we used 10% of the training data as validation data to improve the accuracy of the model.

![normal-xray](https://github.com/rutvik5/pneumonia-detection-using-cnn/blob/master/screenshots/normal.png)![pneumonia-xray](https://github.com/rutvik5/pneumonia-detection-using-cnn/blob/master/screenshots/penumonia.png)

## Model Architecture
The above figure shows our proposed CNN architecture. Our model consists of four feature extractors, each of which consist of one 2-D convolutional layer, a max-pooling layer and a use ReLU activator, a flattening layer and finally two dense layers which act as classifier. Each of these layers take the preceding layer’s output as it’s input except for the first layer. The feature extractors comprise of a 32 3x3 convolutional layer, 64 3x3 convolutional layer, 128 3x3 convolutional layer, and 128 3x3 convolutional layer respectively with a 2x2 max-pooling layers between them. The output of these convolution operations are assembled into feature maps of size 198x198x32, 97x97x62, 46x46x128, 21x21x128 respectively and the output of pooling operations are assembled into feature maps of size 99x99x32, 48x48x64, 23x23x128, and 10x10x128 respectively. Our output labels consist of three classes represented in the form of integer values 0,1,2. Therefore,we used sparse_categorical_crossentropy and sparse_categorical_accuracy as hyperparameters for loss and metric for the model.
